{% extends "base.html" %}


{% block content %}

<div class="col-md-12">

        <ol class="breadcrumb">
          <li><a href="#">CRM</a></li>
          <li><a href="/accounts/list">Accounts</a></li>
          <li class="active">{{ clientDetails.name }} </li>
        </ol>

		<h1>{{ clientDetails.name }} 
            {% if user.group b-and 2 %}<div class="btn-group floatright">
              <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                Action <span class="caret"></span>
              </button>
              <ul class="dropdown-menu pull-right" role="menu">
                <li><a href="/accounts/edit-{% if clientDetails.type == 1 %}client{% else %}supplier{% endif %}/{{ clientDetails.organisationid }}" data-toggle="modal"><i class="glyphicon glyphicon-pencil"></i> Edit</a></li>
                <li><a href="#delete_account" data-toggle="modal"><i class="glyphicon glyphicon-trash"></i> Delete</a></li>
              </ul>
            </div>{% endif %}
         </h1>

</div>


				<div class="col-md-4">
                    <div class="panel panel-default equalheight">
                        <div class="panel-heading">
                            <h3 class="panel-title"><i class="glyphicon glyphicon-phone-alt"></i> Contact Details </h3>
                        </div>
                        <div class="panel-body">
                         <!--   <p><strong>Phone:</strong> <a href="#" name="phone" id="phone" data-type="text" data-pk="{{ clientDetails.organisationid }}" data-url="/accounts/update/{{ clientDetails.organisationid }}" data-title="Enter phone">{{ clientDetails.phone}}</a></p>
                            <p><strong>Email:</strong> <a href="#" name="email" id="email" data-type="text" data-pk="{{ clientDetails.organisationid }}" data-url="/accounts/update/{{ clientDetails.organisationid }}" data-title="Enter email">{{ clientDetails.email}}</a></p>
                            <p><strong>Website:</strong> <a href="#" name="website" id="website" data-type="text" data-pk="{{ clientDetails.organisationid }}" data-url="/accounts/update/{{ clientDetails.organisationid }}" data-title="Enter website">{{ clientDetails.website}}</a></p>-->
                            {% if clientDetails.phone %}<strong>Phone:</strong> {{ clientDetails.phone }}<br />{% endif %}
                            {% if clientDetails.email %}<strong>Email:</strong> {{ clientDetails.email }}<br />{% endif %}
                            {% if clientDetails.website %}<strong>Website:</strong> {{ clientDetails.website }}{% endif %}
                        </div>
                    </div>
                </div>
				<div class="col-md-4">
                    <div class="panel panel-default equalheight">
                        <div class="panel-heading">
                        	<h3 class="panel-title"><i class="glyphicon glyphicon-envelope"></i> Address</h3>
                        </div>
                        <div class="panel-body">
                            {% if clientDetails.address1 %}{{ clientDetails.address1 }}<br />{% endif %}
                            {% if clientDetails.address2 %}{{ clientDetails.address2 }}<br />{% endif %}
                            {% if clientDetails.address3 %}{{ clientDetails.address3 }}<br />{% endif %}
                            {% if clientDetails.town %}{{ clientDetails.town }}<br />{% endif %}
                            {% if clientDetails.county %}{{ clientDetails.county }}<br />{% endif %}
                            {% if clientDetails.postcode %}{{ clientDetails.postcode }}{% endif %}
                        </div>
                    </div>
                </div>
				<div class="col-md-4">
                    <div class="panel panel-default equalheight">
                        <div class="panel-heading">
                            <h3 class="panel-title"><i class="glyphicon glyphicon-info-sign"></i> Account Info</h3>
                        </div>
                        <div class="panel-body">
                            <strong>Account Manager:</strong> {{ getAccMgrName(clientDetails.accountmanagerid) }}<br />
                            <strong>Source:</strong> {{ getSourceName(clientDetails.sourceid) }}<br />
                            <strong>First contact:</strong> {% if clientDetails.firstcontact %}{{ clientDetails.firstcontact|date("d/m/Y") }}{% endif %}<br />
                            <strong>Next contact:</strong> {% if clientDetails.nextdate %}{{ clientDetails.nextdate|date("d/m/Y") }}{% endif %}<br />
                            <strong>Sector:</strong> {{ getSectorName(clientDetails.sectorid) }}<br />
                            <strong>Services:</strong> {{ getServicesName(clientDetails.services) }}
                        </div>
                    </div>
                </div>

<div class="col-md-12">

         <div class="tabbable">
             <ul class="nav nav-tabs">
                <li class="active">
                  <a href="#contacts" id="myTabDrop1" data-toggle="tab"><i class="glyphicon glyphicon-user"></i> <span>Contacts</span> <!--<span class="badge">{{ contacts | length }}</span>--> </a>
                </li>
                {% if user.group b-and 16 %}
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                      <i class="glyphicon glyphicon-book"></i> Jobs <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a href="#jobs" data-toggle="tab">Live Jobs</a></li>
                      <li><a href="#closed_jobs" data-toggle="tab">Closed Jobs</a></li>
                    </ul>
                  </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                      <i class="icon-file-text"></i> Estimates <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a href="#estimates" data-toggle="tab">Live Estimates</a></li>
                      <li><a href="#archived_estimates" data-toggle="tab">Archived Estimates</a></li>
                    </ul>
                  </li>
                  <!--  <li class="">
                      <a href="#jobs" data-toggle="tab"><i class="glyphicon glyphicon-book"></i> <span>Jobs</span> </a>
                    </li>
                   <li>
                      <a href="#estimates" id="myTabDrop1" data-toggle="tab"><i class="icon-file-text"></i> Estimates </a>
                    </li>-->
                {% endif %}
                <li class="">
                  <a href="#notes" data-toggle="tab"><i class="glyphicon glyphicon-comment"></i> <span>Notes</span> <span class="badge">{{ notes|length }}</span></a>
                </li>
                {% if user.group b-and 1024 %}
                <li class="">
                  <a href="#hosting" data-toggle="tab"><i class="glyphicon glyphicon-globe"></i> <span>Hosting</span> </a>
                </li>
                {% endif %}
                {% if brands|length %}
                <li class="">
                  <a href="#brands" data-toggle="tab"><i class="glyphicon glyphicon-registration-mark"></i> <span>Brands</span> </a>
                </li>
                {% endif %}
                <!--<li class="">
                  <a href="#files" id="myTabDrop3" data-toggle="tab"><i class="glyphicon glyphicon-file"></i> <span>Files</span> </a>
                </li>-->
                {% if user.group b-and 4 %}<li class="dropdown">
                  <a href="#tickets" id="myTabDrop3" data-toggle="tab"><i class="glyphicon glyphicon-bookmark"></i> <span>Tickets</span> <!--<span class="badge ">{{ tickets|length }}</span>--></a>
                </li>{% endif %}
                {% if user.group b-and 2 %}<li class="dropdown navbar-right">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-plus"></i> <span>Add New</span></a>
                    <ul class="dropdown-menu pull-right" role="menu">
                        <li><a href="#add_contact" data-toggle="tab">Contact</a></li>
                        {% if user.group b-and 32 %}<li><a href="#add_job" data-toggle="tab">Job</a></li>
                        <li><a href="#add_estimate" data-toggle="tab">Estimate</a></li>{% endif %}
                        <li><a href="#add_note" data-toggle="tab"> Note</a></li>
                        <li><a href="#add_hosting" data-toggle="tab"> Hosting</a></li>
                        <li><a href="#add_ticket" data-toggle="tab">Ticket</a></li>
                        <li><a href="#add_brand" data-toggle="tab">Brand</a></li>
                    </ul>
                </li>{% endif %}
            </ul>
        </div>

	<br />

             <div class="tab-content">
                
            
                <div class="tab-pane" id="details">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title"><i class="glyphicon glyphicon-phone-alt"></i> Contact Details </h3>
                            <a href="/tickets/view/{{ clientDetails.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                        </div>
                        <div class="panel-body">
                            <p><strong>Phone:</strong> <a href="#" name="phone" id="phone" data-type="text" data-pk="{{ clientDetails.organisationid }}" data-url="/accounts/update/{{ clientDetails.organisationid }}" data-title="Enter phone">{{ clientDetails.phone}}</a></p>
                            <p><strong>Email:</strong> <a href="#" name="email" id="email" data-type="text" data-pk="{{ clientDetails.organisationid }}" data-url="/accounts/update/{{ clientDetails.organisationid }}" data-title="Enter email">{{ clientDetails.email}}</a></p>
                            <p><strong>Website:</strong> <a href="#" name="website" id="website" data-type="text" data-pk="{{ clientDetails.organisationid }}" data-url="/accounts/update/{{ clientDetails.organisationid }}" data-title="Enter website">{{ clientDetails.website}}</a></p>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                        	<h3 class="panel-title"><i class="glyphicon glyphicon-envelope"></i> Address</h3>
                            <a href="/tickets/view/{{ clientDetails.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                        </div>
                        <div class="panel-body">
                            {% if clientDetails.address1 %}{{ clientDetails.address1 }}<br />{% endif %}
                            {% if clientDetails.address2 %}{{ clientDetails.address2 }}<br />{% endif %}
                            {% if clientDetails.address3 %}{{ clientDetails.address3 }}<br />{% endif %}
                            {% if clientDetails.town %}{{ clientDetails.town }}<br />{% endif %}
                            {% if clientDetails.county %}{{ clientDetails.county }}<br />{% endif %}
                            {% if clientDetails.postcode %}{{ clientDetails.postcode }}{% endif %}
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title"><i class="glyphicon glyphicon-info-sign"></i> Account Info</h3>
                            <a href="/tickets/view/{{ clientDetails.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                        </div>
                        <div class="panel-body">
                            <p><strong>Account Manager:</strong> {{ clientDetails.firstname }} {{ clientDetails.lastname }}</p>
                            <p><strong>Source:</strong> {{ clientDetails.sourcename }}</p>
                            <p><strong>Firstcontact:</strong> {{ clientDetails.firstcontact }}</p>
                            <p><strong>Sector:</strong> {{ clientDetails.sectorname }}</p>
                            <p><strong>Services:</strong> {{ clientDetails.services }}</p>
                        </div>
                    </div>
                </div>
                
                 <div class="tab-pane active" id="contacts">
                    {% for contact in contacts %}
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">{{ contact.firstname}} {{ contact.lastname}}</h3> 
                            <a href="/contacts/view/{{ contact.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-zoom-in"></i> View</a>
                        </div>
                        <div class="panel-body">
                            <strong>Position:</strong> {{ contact.position }}<br />
                            <strong>Phone:</strong> {{ contact.phone }}<br />
                            <strong>Mobile:</strong> {{ contact.mobile }}<br />
                           <strong> Email:</strong> {{ contact.email }}
                        </div>
                    </div>
                    {% endfor %}
                    <!--
                    <div class="nav nav-tabs nav-stacked">
                    {% for contact in contacts %}
                        <a href="/contacts/view/{{ contact.id}}" class="list-group-item">{{ contact.firstname}} {{ contact.lastname}}</a>
                    {% endfor %}
                    </div>
                    -->
                 </div>
                 
                 <div class="tab-pane" id="jobs">
                    <!--<p><a href="#add_person"class="btn btn-primary" data-toggle="modal"><i class="glyphicon glyphicon-plus"></i> Add New Job</a></p>-->
                    {% for job in jobs %}
                        {% if job.statusid == 1 %}
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">{% if job.jobnumber %}{{ job.jobnumber }} - {% endif %}{{ job.title }}</h3>
                                    <a href="/jobs/view/{{ job.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-zoom-in"></i> View</a>
                                  <!--   <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                                    <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-trash"></i> Delete</a>-->
                                </div>
                                <div class="panel-body">
                                    <strong>Description:</strong> {{ job.description}}<br />
                                    <strong>Value:</strong> £{{ job.value }}<br />
                                    <strong>Date:</strong> {{ job.date|date("d/m/Y") }}<br />
                                    <strong>Acc Mgr:</strong> {{ getAccMgrName(job.accountmanagerid) }}<br />
                                    <strong>Status:</strong> {{ getJobStatusName(job.statusid) }}
                                </div>
                            </div>
                         {% endif %}
                    {% endfor %}
                 </div>

                 <div class="tab-pane" id="closed_jobs">
                    <!--<p><a href="#add_person"class="btn btn-primary" data-toggle="modal"><i class="glyphicon glyphicon-plus"></i> Add New Job</a></p>-->
                    {% for job in jobs %}
                        {% if job.statusid == 3 %}
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">{% if job.jobnumber %}{{ job.jobnumber }} - {% endif %}{{ job.title }}</h3>
                                    <a href="/jobs/view/{{ job.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-zoom-in"></i> View</a>
                                  <!--   <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                                    <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-trash"></i> Delete</a>-->
                                </div>
                                <div class="panel-body">
                                    <strong>Description:</strong> {{ job.description}}<br />
                                    <strong>Value:</strong> £{{ job.value }}<br />
                                    <strong>Date:</strong> {{ job.date|date("d/m/Y") }}<br />
                                    <strong>Acc Mgr:</strong> {{ getAccMgrName(job.accountmanagerid) }}<br />
                                    <strong>Status:</strong> {{ getJobStatusName(job.statusid) }}
                                </div>
                            </div>
                         {% endif %}
                    {% endfor %}
                 </div>

                 <div class="tab-pane" id="estimates">
                    <!--<p><a href="#add_person"class="btn btn-primary" data-toggle="modal"><i class="glyphicon glyphicon-plus"></i> Add New Job</a></p>-->
                    {% for job in jobs %}
                        {% if job.statusid == 2 %}
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">{{ job.title }}</h3>
                                    <a href="/jobs/view/{{ job.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-zoom-in"></i> View</a>
                                  <!--   <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                                    <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-trash"></i> Delete</a>-->
                                </div>
                                <div class="panel-body">
                                    <strong>Description:</strong> {{ job.description}}<br />
                                    <strong>Value:</strong> £{{ job.value }}<br />
                                    <strong>Date:</strong> {{ job.date|date("d/m/Y") }}<br />
                                    <strong>Acc Mgr:</strong> {{ getAccMgrName(job.accountmanagerid) }}<br />
                                    <strong>Status:</strong> {{ getJobStatusName(job.statusid) }}
                                </div>
                            </div>
                         {% endif %}
                    {% endfor %}
                 </div>

                 <div class="tab-pane" id="archived_estimates">
                    <!--<p><a href="#add_person"class="btn btn-primary" data-toggle="modal"><i class="glyphicon glyphicon-plus"></i> Add New Job</a></p>-->
                    {% for job in jobs %}
                        {% if job.statusid == 5 %}
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">{{ job.title }}</h3>
                                    <a href="/jobs/view/{{ job.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-zoom-in"></i> View</a>
                                  <!--   <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                                    <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-trash"></i> Delete</a>-->
                                </div>
                                <div class="panel-body">
                                    <strong>Description:</strong> {{ job.description}}<br />
                                    <strong>Value:</strong> £{{ job.value }}<br />
                                    <strong>Date:</strong> {{ job.date|date("d/m/Y") }}<br />
                                    <strong>Acc Mgr:</strong> {{ getAccMgrName(job.accountmanagerid) }}<br />
                                    <strong>Status:</strong> {{ getJobStatusName(job.statusid) }}
                                </div>
                            </div>
                         {% endif %}
                    {% endfor %}
                 </div>

                 <div class="tab-pane" id="notes">
                    {% for note in notes %}
                    <div class="panel panel-default">
                        <div class="panel-heading">
                        	{{ note.date|date }}
                            <span class="floatright lighttext">{{ note.employee_firstname }}{% if note.contact_firstname %} > {{ note.contact_firstname }}{% endif %}{% if note.jobid %} | <a href="/jobs/view/{{ note.jobid }}">{{ getJobTitle(note.jobid) }}</a>{% endif %}</span>
                        </div>
                       <div class="panel-body">
                            {{ note.body }}
                        </div>
                        {% if note.filenames != '' %}
                            <div class="panel-footer">
                            {% for i in note.filenames|split(',') %}
                                <a href="/attachments/{{ i }}"  class="btn btn-default btn-xs">{{ i }} <i class="glyphicon glyphicon-paperclip"></i></a>
                            {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                 </div>

                 <div class="tab-pane" id="hosting">
                    {% for record in hosting %}
                    <div class="panel panel-default">
                        <div class="panel-heading">
                        	<h3 class="panel-title">{% if record.type == 1 %}<i class="glyphicon glyphicon-globe"></i>{% else %}<i class="glyphicon glyphicon-hdd"></i>{% endif %} {{ record.description }}</h3>
                             <a href="/hosting/view/{{ record.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-zoom-in"></i> View</a>
                       </div>
                       <div class="panel-body">
                            <strong>Expiry date:</strong> {{ record.expirydate|date("d/m/Y") }}
                        </div>
                    </div>
                    {% endfor %}
                 </div>

                 <div class="tab-pane" id="brands">
                    {% for brand in brands %}
                        <a href="#" class="list-group-item">{{ brand.name }}</a>
                    {% endfor %}
                 </div>
                 
                 <div class="tab-pane" id="tickets">
                    {% for ticket in tickets %}
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">{{ ticket.subject}}</h3>
                            <a href="/tickets/view/{{ ticket.id}}" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-zoom-in"></i> View</a>
                        <!--    <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
                            <a href="#" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-trash"></i> Delete</a>-->
                        </div>
                        <div class="panel-body">
                            <strong>Subject:</strong> {{ ticket.body }}<br />
                            <strong>Status:</strong> {{ getTicketStateName(ticket.statusid) }}<br />
                            <strong>Tracking ID:</strong> {{ ticket.trackingid }}<br />
                            <strong>Last Updated:</strong> {{ ticket.lastchanged }}
                        </div>
                    </div>
                    {% endfor %}
                 </div>

     <!------------ FORMS -------------->
                 
                 <div class="tab-pane" id="add_brand">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">New Brand</h3>
                        </div>
                        <div class="panel-body">
                            <form role="form" name="addReply" method="post" action="/accounts/add-brand" enctype="multipart/form-data">
                                <div><input type="hidden" class="form-control" name="brandCompany" id="brandCompany" value="{{ clientDetails.organisationid }}"></div>
                                <div class="form-group">
                                    <label for="contactName">Brand Name</label>
                                    <input type="text" class="form-control" name="brandName" id="brandName" placeholder="Enter name" data-validation="required">
                                </div>
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>  
                        </div>
                    </div>
                </div>

               <div class="tab-pane" id="add_note">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">New Note</h3>
                        </div>
                        <div class="panel-body">
                            <form role="form" name="addReply" method="post" action="/notes/add" enctype="multipart/form-data">
                                <div><input type="hidden" class="form-control" name="noteCompany" id="noteCompany" value="{{ clientDetails.organisationid }}"></div>
                                <div class="form-group">
                                    <textarea class="form-control" rows="3" id="noteBody" name="noteBody"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="noteContact">Contact</label>
                                    <select class="form-control" id="noteContact" name="noteContact">
                                    <option value="">-- select --</option>
                                        {% for contact in contacts %}
                                    		<option value="{{ contact.id}}">{{ contact.firstname }} {{ contact.lastname }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="noteJob">Job</label>
                                    <select class="form-control" id="noteJob" name="noteJob">
                                    <option value="">-- select --</option>
                                        {% for job in jobs %}
                                    		<option value="{{ job.id}}">{{ job.jobnumber }} - {{ job.title }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="noteAttachment">Attachment</label>
                                    <input type="file" id="noteAttachment" name="noteAttachment[]" class="noteAttachment">
                                    <br />
                                    <button class="addFileUpload btn btn-success btn-xs"><i class="glyphicon glyphicon-plus"></i> Add more attachments</button>
                                </div>
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>  
                        </div>
                    </div>
                </div>
                
                <div class="tab-pane" id="add_contact">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">New Contact Details</h3>
                        </div>
                        <div class="panel-body">
                            <form role="form" name="addContact" id="addContact" method="post" action="/contacts/add">
                                <div><input type="hidden" class="form-control" name="contactCompany" id="contactCompany" value="{{ clientDetails.organisationid }}"></div>
                                <div class="form-group">
                                    <label for="contactName">First Name</label>
                                    <input type="text" class="form-control" name="contactFirstName" id="contactFirstName" placeholder="Enter first name" data-validation="required">
                                </div>
                                <div class="form-group">
                                    <label for="contactName">Last Name</label>
                                    <input type="text" class="form-control" name="contactLastName" id="contactLastName" placeholder="Enter last name" data-validation="required">
                                </div>
                                <div class="form-group">
                                    <label for="contactPosition">Position</label>
                                    <input type="text" class="form-control" name="contactPosition" id="contactPosition" placeholder="Enter position">
                                </div>
                                <div class="form-group">
                                    <label for="contactPhone">Phone number</label>
                                    <input type="text" class="form-control" name="contactPhone" id="contactPhone" placeholder="Enter phone number">
                                </div>
                                <div class="form-group">
                                    <label for="contactMobile">Mobile number</label>
                                    <input type="text" class="form-control" name="contactMobile" id="contactMobile" placeholder="Enter mobile number">
                                </div>
                                <div class="form-group">
                                    <label for="contactEmail">Email address</label>
                                    <input type="email" class="form-control" name="contactEmail" id="contactEmail" placeholder="Enter email address">
                                </div>
                                <button type="submit" name="save" class="btn btn-primary">Save</button>
                                <button type="submit" name="new" class="btn btn-primary">Save and Add New</button>
                            </form>
                        </div>
                    </div>
               </div>

                <div class="tab-pane" id="add_job">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">New Job Details</h3>
                        </div>
                    <div class="panel-body">
                        <form role="form" name="addJob" id="addJob" method="post" action="/jobs/add">
                            <div><input type="hidden" class="form-control" name="jobCompany" id="jobCompany" value="{{ clientDetails.organisationid }}"></div>
                            <div class="form-group">
                                <label for="jobBrand">Company Brand</label> <a href="#add_brand_modal" data-toggle="modal">Add</a>
                                    <select class="form-control" id="jobBrand" name="jobBrand">
                                    <option value="">N/A</option>
                                    {% for brand in brands %}
                                        <option value="{{ brand.id }}">{{ brand.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="jobContact">Company Contact</label> <a href="#add_contact_modal" data-toggle="modal">Add</a>
                                    <select class="form-control" id="jobContact" name="jobContact">
                                    <option value="">-- select --</option>
                                    {% for contact in contacts %}
                                        <option value="{{ contact.id }}">{{ contact.firstname }} {{ contact.lastname }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                          <div class="form-group">
                            <label for="jobAccManager">Account Manager *</label>
                            <select class="form-control" id="jobAccManager" name="jobAccManager" data-validation="required">
                              <option value="">- select -</option>
                                {% for manager in global_accountmanagers %}
                                    <option value="{{ manager.id }}">{{ manager.firstname }} {{ manager.lastname }}</option>
                                {% endfor %}
                            </select>
                          </div>
                            <div class="form-group form-inline">
                                <label for="jobValue">Value</label>
                                <div class="input-group">
                                    <span class="input-group-addon">£</span>
                                    <input type="text" class="form-control" name="jobValue" id="jobValue" placeholder="Enter value">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="jobType">Type</label>
                                <select class="form-control" id="jobType" name="jobType" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for type in global_jobtypes %}
                                        <option value="{{ type.id }}">{{ type.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="jobCategory">Category</label>
                                <select class="form-control" id="jobCategory" name="jobCategory" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for type in global_jobcategories %}
                                        <option value="{{ type.id }}">{{ type.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="jobDate">Date</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="icon-calendar"></i></span>
                                    <input type="text" class="form-control datepicker" name="jobDate" id="jobDate" placeholder="Select date" value="{{ date()|date("d/m/Y") }}" data-validation="required">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="jobTitle">Title</label>
                                <input type="text" class="form-control" name="jobTitle" id="jobTitle" placeholder="Enter job title" data-validation="required">
                            </div>
                              <div class="form-group">
                                <label for="jobDescription">Description</label>
                                <textarea class="form-control" rows="3" id="jobDescription" name="jobDescription" placeholder="Enter description" data-validation="required"></textarea>
                              </div>
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </form>
                    </div>
                </div>
            </div>

                <div class="tab-pane" id="add_estimate">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">New Estimate Details</h3>
                        </div>
                    <div class="panel-body">
                        <form role="form" name="addEstimate" id="addEstimate" method="post" action="/jobs/add-estimate">
                            <div><input type="hidden" class="form-control" name="estimateCompany" id="estimateCompany" value="{{ clientDetails.organisationid }}"></div>
                            <div class="form-group">
                                <label for="jobBrand">Company Brand</label>
                                    <select class="form-control" id="jobBrand" name="jobBrand">
                                    <option value="">N/A</option>
                                    {% for brand in brands %}
                                        <option value="{{ brand.id }}">{{ brand.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="jobContact">Company Contact</label>
                                    <select class="form-control" id="estimateContact" name="estimateContact">
                                    <option value="">-- select --</option>
                                    {% for contact in contacts %}
                                        <option value="{{ contact.id }}">{{ contact.firstname }} {{ contact.lastname }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                          <div class="form-group">
                            <label for="estimateAccManager">Account Manager *</label>
                            <select class="form-control" id="estimateAccManager" name="estimateAccManager" data-validation="required">
                              <option value="">- select -</option>
                                {% for manager in global_accountmanagers %}
                                    <option value="{{ manager.id }}">{{ manager.firstname }} {{ manager.lastname }}</option>
                                {% endfor %}
                            </select>
                          </div>
                            <div class="form-group form-inline">
                                <label for="estimateValue">Value</label>
                                <div class="input-group">
                                    <span class="input-group-addon">£</span>
                                    <input type="text" class="form-control" name="estimateValue" id="estimateValue" placeholder="Enter value">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="estimateType">Type *</label>
                                <select class="form-control" id="estimateType" name="estimateType" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for type in global_jobtypes %}
                                        <option value="{{ type.id }}">{{ type.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="jobCategory">Category</label>
                                <select class="form-control" id="jobCategory" name="jobCategory" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for type in global_jobcategories %}
                                        <option value="{{ type.id }}">{{ type.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="estimateDate">Date *</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="icon-calendar"></i></span>
                                    <input type="text" class="form-control datepicker" name="estimateDate" id="estimateDate" placeholder="Select date" value="{{ date()|date("d/m/Y") }}" data-validation="required">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="estimateTitle">Title *</label>
                                <input type="text" class="form-control" name="estimateTitle" id="estimateTitle" placeholder="Enter job title" data-validation="required">
                            </div>
                              <div class="form-group">
                                <label for="estimateDescription">Description *</label>
                                <textarea class="form-control" rows="3" id="estimateDescription" name="estimateDescription" placeholder="Enter description" data-validation="required"></textarea>
                              </div>
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="tab-pane" id="add_ticket">
                <form role="form" name="addTicket" id="addTicket" method="post" action="/tickets/add">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">New Ticket Details</h3>
                        </div>
                    <div class="panel-body">
                            <div class="form-group">
                                <label for="ticketSubject">Subject</label>
                                <input type="text" class="form-control" name="ticketSubject" id="ticketSubject" placeholder="Enter ticket subject" data-validation="required">
                            </div>
                       </div>
                        <div class="panel-heading">
                            <h3 class="panel-title">Company Info</h3>
                        </div>
                        <div class="panel-body">
                            <div><input type="hidden" class="form-control" name="ticketCompany" id="ticketCompany" value="{{ clientDetails.organisationid }}"></div>
                            <div class="form-group">
                                <label for="ticketContact">Company Contact</label>
                                <select class="form-control" id="ticketContact" name="ticketContact" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for contact in contacts %}
                                        <option value="{{ contact.id }}">{{ contact.firstname }} {{ contact.lastname }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="ticketJob">Job</label>
                                <select class="form-control" id="ticketJob" name="ticketJob">
                                    <option value="">-- select --</option>
                                    {% for job in jobs %}
                                        <option value="{{ job.id}}">{{ job.id }} - {{ job.title }}</option>
                                    {% endfor %}
                               </select>
                            </div>
                        </div>
                        <div class="panel-heading">
                            <h3 class="panel-title">Ticket Assignment</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label for="ticketDepartment">Department</label>
                                <select class="form-control" id="ticketDepartment" name="ticketDepartment" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for item in global_ticket_departments %}
                                        <option value="{{ item.id }}" >{{ item.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="ticketAssigned">Assigned To</label>
                                <select class="form-control" id="ticketAssigned" name="ticketAssigned" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for item in global_ticket_support_agents %}
                                        <option value="{{ item.id }}" >{{ item.firstname }} {{ item.lastname }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="panel-heading">
                            <h3 class="panel-title">Ticket Status</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label for="ticketStatus">Status</label>
                                <select class="form-control" id="ticketStatus" name="ticketStatus" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for item in global_ticket_states %}
                                        <option value="{{ item.id }}" >{{ item.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="ticketPriority">Priority</label>
                                <select class="form-control" id="ticketPriority" name="ticketPriority" data-validation="required">
                                    <option value="">-- select --</option>
                                    {% for item in global_ticket_priorities %}
                                        <option value="{{ item.id }}" >{{ item.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="jobDate">Date Created</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="icon-calendar"></i></span>
                                    <input type="text" class="form-control datepicker" name="jobDate" id="jobDate" placeholder="Select date" value="{{ date()|date("m/d/Y") }}" data-validation="required">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </form>
        </div>


        <div class="tab-pane" id="add_hosting">
            <form role="form" name="addHosting" id="addHosting" method="post" action="/hosting/add">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">New Web Hosting Details</h3>
                </div>
            <div class="panel-body">
                    <div><input type="hidden" class="form-control" name="hostingCompany" id="hostingCompany" value="{{ clientDetails.organisationid }}"></div>
                    <div class="form-group">
                        <label for="hostingType">Hosting Type</label>
                        <select class="form-control" id="hostingType" name="hostingType" data-validation="required">
                        <option value="">-- select --</option>
                            {% for item in global_hosting_types %}
                                <option value="{{ item.id }}" >{{ item.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="hostingJob">Job</label>
                        <select class="form-control webJob" id="hostingJob" name="hostingJob" >
                            <option value="">-- select --</option>
                            {% for job in jobs %}
                                <option value="{{ job.id}}">{{ job.id }} - {{ job.title }}</option>
                            {% endfor %}
                       </select>
                    </div>
                    <div class="form-group">
                        <label for="hostingDescription">Description</label>
                        <input type="text" class="form-control" name="hostingDescription" id="hostingDescription" placeholder="Enter description" data-validation="required">
                    </div>
                    <div class="form-group form-inline">
                        <label for="hostingValue">Value</label>
                        <div class="input-group">
                            <span class="input-group-addon">£</span>
                            <input type="text" class="form-control" name="hostingValue" id="hostingValue" placeholder="Enter value" data-validation="required" data-pattern="[0-9]+">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="hostingExpiryDate">Expiry Date</label>
                        <div class="input-group">
                            <span class="input-group-addon"><i class="icon-calendar"></i></span>
                            <input type="text" class="form-control datepicker" name="hostingExpiryDate" id="hostingExpiryDate" placeholder="Select date" value="{{ date()|date("m/d/Y") }}" data-validation="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="hostingPeriod">Renewal Period</label>
                        <input type="text" class="form-control" name="hostingPeriod" id="hostingPeriod" placeholder="Enter number of months" data-validation="required" data-pattern="[0-9]+">
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </div>
        </form>
       </div>

            </div>

     <!------------ /FORMS -------------->
                 
         </div>
     </div>
    
     

</div>

    <!------------ MODAL FORMS -------------->

    <div class="modal fade" id="delete_account">
        <div class="modal-dialog">
            <div class="modal-content">
                <form role="form" name="deleteAccount" method="post" action="/accounts/delete/{{ clientDetails.organisationid }}">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Delete Account</h4>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete {{ clientDetails.name }} and it's contacts?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="add_brand_modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Create Brand</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="brandName_modal">Brand Name *</label>
                        <input type="text" class="form-control" name="brandName_modal" id="brandName_modal" placeholder="Enter brand name" data-validation="required">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-success" id="submit_add_brand">Create Brand</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="add_contact_modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Create Contact</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="firstName_modal">First Name *</label>
                        <input type="text" class="form-control" name="firstName_modal" id="firstName_modal" placeholder="Enter first name" data-validation="required">
                    </div>
                    <div class="form-group">
                        <label for="lastName_modal">Last Name *</label>
                        <input type="text" class="form-control" name="lastName_modal" id="lastName_modal" placeholder="Enter last name" data-validation="required">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-success" id="submit_add_contact">Create Contact</button>
                </div>
            </div>
        </div>
    </div>

<script>
    $.validate({  });
</script>
<script type="text/javascript">
    
    $(document).ready(function() {
		
		$(".equalheight").equalHeights();
		
        /*$('form').validate({
            onKeyup : true,
            eachValidField : function() {

                $(this).parent().removeClass('has-error').addClass('has-success');
            },
            eachInvalidField : function() {

                $(this).parent().removeClass('has-success').addClass('has-error');
            }
        });*/

		$('#submit_add_brand').click(function(){

				$.ajax({
					type: "GET",
					url: "/ajax/accounts/add-brand/{{ clientDetails.organisationid }}/" + $('#brandName_modal').val(),
					dataType: "html",
					success: function(data) {
						
						$('#add_brand_modal').modal('hide');
						
						var _newId = data;

						$.ajax({
							type: "GET",
							url: "/xml/brands/{{ clientDetails.organisationid }}",
							dataType: "xml",
							success: function(xml) {
								var select = $('#jobBrand');
								select.attr("disabled","disabled");
								select.children().remove();
								select.append("<option value=''>N/A</option>");
								$(xml).find('item').each(function(){
									var name = $(this).find('name').text();
									var id = $(this).find('id').text();
									select.append("<option value="+id+">"+name+"</option>");
								});
								select.removeAttr("disabled");
								select.val( _newId );
							}
						});

					}
				});
		
		});

		$('#submit_add_contact').click(function(){

				$.ajax({
					type: "GET",
					url: "/ajax/contacts/add/{{ clientDetails.organisationid }}/" + $('#firstName_modal').val() + "/" + $('#lastName_modal').val(),
					dataType: "html",
					success: function(data) {
						
						$('#add_contact_modal').modal('hide');
						
						var _newId = data;

						$.ajax({
							type: "GET",
							url: "/xml/contacts/{{ clientDetails.organisationid }}",
							dataType: "xml",
							success: function(xml) {
								var select = $('#jobContact');
								select.attr("disabled","disabled");
								select.children().remove();
								select.append("<option value=''>-- select --</option>");
								$(xml).find('item').each(function(){
									var name = $(this).find('name').text();
									var id = $(this).find('id').text();
									select.append("<option value="+id+">"+name+"</option>");
								});
								select.removeAttr("disabled");
								select.val( _newId );
							}
						});

					}
				});
		
		});


    });
    
</script>

          
{% endblock %}